<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tic-Tac-Toe Game</title>
  <style>
    :root {
      --bg: #121212;
      --board: #272737;
      --grid: #fff1;
      --accent: #ff073a;
      --o: #3ee8ff;
      --x: #ff073a;
      --win: #fff38b;
    }
    body {
      background: var(--bg);
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px;
    }
    h1 {
      color: var(--accent);
      font-size: 2em;
      text-align: center;
    }
    .settings {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      background: #171726;
      border-radius: 12px;
      padding: 12px 20px;
      margin-bottom: 15px;
      box-shadow: 0 4px 18px #ff073a24;
    }
    .settings label {
      font-size: 1em;
    }
    select, .settings input[type="button"] {
      padding: 5px 10px;
      border-radius: 5px;
      border: none;
      background: #252541;
      color: #fff;
    }
    .settings input[type="button"] {
      background: var(--accent);
      font-weight: bold;
      cursor: pointer;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(3, minmax(70px, 100px));
      grid-template-rows: repeat(3, minmax(70px, 100px));
      gap: 1px;
      background: var(--board);
      border-radius: 12px;
      box-shadow: 0 0 0 8px #191926ed inset;
    }
    .cell {
      background: transparent;
      font-size: 2em;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Montserrat', sans-serif;
      cursor: pointer;
      user-select: none;
      border: 1px solid var(--grid);
    }
    .cell[data-value="X"] {
      color: var(--x);
      text-shadow: 0 0 8px var(--x);
    }
    .cell[data-value="O"] {
      color: var(--o);
      text-shadow: 0 0 8px var(--o);
    }
    .cell.win {
      background: var(--win);
      color: #000 !important;
    }
    .status {
      margin-top: 15px;
      font-size: 1.2em;
      text-align: center;
    }
    .scoreboard {
      display: flex;
      gap: 20px;
      margin-top: 10px;
      padding: 10px 15px;
      background: #161628;
      border-radius: 10px;
    }
    .scoreboard span {
      font-size: 1.1em;
    }
    .score-x { color: var(--x); }
    .score-o { color: var(--o); }
    .score-tie { color: var(--win); }

    @media (max-width: 500px) {
      .cell {
        font-size: 1.5em;
      }
    }
  </style>
</head>
<body>
  <h1>Tic-Tac-Toe</h1>
  <div class="settings">
    <label>Mode:
      <select id="modeSelect">
        <option value="human">2 Players</option>
        <option value="cpu">Vs Computer</option>
      </select>
    </label>
    <label>First Move:
      <select id="firstSelect">
        <option value="X">X</option>
        <option value="O">O</option>
      </select>
    </label>
    <input type="button" id="restartBtn" value="Restart">
  </div>

  <div class="scoreboard">
    <span>X (<span class="score-x">0</span>)</span>
    <span>O (<span class="score-o">0</span>)</span>
    <span>Tie (<span class="score-tie">0</span>)</span>
  </div>

  <div class="status" id="status"></div>
  <div class="board" id="board"></div>

  <!-- ðŸŽµ AUDIO FILES -->
  <audio id="bgm" src="01.mpeg" loop autoplay></audio>
  <audio id="clickSound" src="03.mpeg"></audio>
  <audio id="winSound" src="02.mpeg"></audio>

  <script>
    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const restartBtn = document.getElementById('restartBtn');
    const modeSelect = document.getElementById('modeSelect');
    const firstSelect = document.getElementById('firstSelect');
    const scoreXEl = document.querySelector('.score-x');
    const scoreOEl = document.querySelector('.score-o');
    const scoreTieEl = document.querySelector('.score-tie');

    const bgm = document.getElementById("bgm");
    bgm.volume = 0.3;
    const clickSound = document.getElementById("clickSound");
    const winSound = document.getElementById("winSound");

    window.addEventListener("click", () => {
      bgm.play().catch(() => {});
    }, { once: true });

    let board, turn, gameOver, mode, moves, scores;

    function resetScores() {
      scores = { X: 0, O: 0, tie: 0 };
      updateScore();
    }

    function updateScore() {
      scoreXEl.textContent = scores.X;
      scoreOEl.textContent = scores.O;
      scoreTieEl.textContent = scores.tie;
    }

    function startGame() {
      board = Array(9).fill('');
      moves = 0;
      turn = firstSelect.value;
      mode = modeSelect.value;
      gameOver = false;
      render();
      statusEl.textContent = mode === 'human'
        ? `Player ${turn}'s turn`
        : (turn === 'X' ? 'Your turn (X)' : "Computer's turn (O)");
      if (mode === 'cpu' && turn === 'O') setTimeout(cpuMove, 400);
    }

    function render() {
      boardEl.innerHTML = '';
      board.forEach((val, i) => {
        const cell = document.createElement('div');
        cell.className = 'cell';
        if (val) cell.setAttribute('data-value', val);
        cell.dataset.idx = i;
        cell.textContent = val;
        cell.onclick = () => !gameOver && !val && handleMove(i);
        boardEl.appendChild(cell);
      });
    }

    function handleMove(i) {
      if (board[i] || gameOver) return;
      clickSound.currentTime = 0;
      clickSound.play();
      board[i] = turn;
      moves++;
      render();
      let win = checkWin();
      if (win) {
        winSound.currentTime = 0;
        winSound.play();
        win.forEach(idx => boardEl.children[idx].classList.add('win'));
        statusEl.textContent = (mode === 'cpu' && turn === 'O')
          ? 'Computer Wins!' : `Player ${turn} Wins!`;
        scores[turn]++;
        gameOver = true;
        updateScore();
        return;
      }
      if (moves === 9) {
        statusEl.textContent = "It's a Tie!";
        scores.tie++;
        gameOver = true;
        updateScore();
        return;
      }
      turn = turn === 'X' ? 'O' : 'X';
      statusEl.textContent = mode === 'human'
        ? `Player ${turn}'s turn`
        : (turn === 'X' ? 'Your turn (X)' : "Computer's turn (O)");
      if (mode === 'cpu' && turn === 'O' && !gameOver) setTimeout(cpuMove, 400);
    }

    function cpuMove() {
      const available = board.map((v, i) => v === '' ? i : null).filter(i => i !== null);
      const idx = available[Math.floor(Math.random() * available.length)];
      handleMove(idx);
    }

    function checkWin() {
      const wins = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      for (const [a,b,c] of wins)
        if (board[a] && board[a] === board[b] && board[b] === board[c])
          return [a,b,c];
      return null;
    }

    restartBtn.onclick = startGame;
    modeSelect.onchange = startGame;
    firstSelect.onchange = startGame;

    resetScores();
    startGame();
  </script>
</body>
</html>
